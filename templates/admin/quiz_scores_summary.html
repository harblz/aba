{% extends "admin/change_list.html" %}

{% load quiz_extras %}

{% load i18n %}
{% load humanize %}
<!-- { load mathtags } !-->
{% load tz %}

{% block content_title %}
    <h1> Quiz Score Summary </h1>
{% endblock content_title %}

{% block result_list %}
<div class="results">

    <h2> Average Scores Over Time </h2>

    <style>

      .bar-chart {
        display: flex;
        justify-content: space-around;
        height: 160px;
        padding-top: 60px;
        overflow: hidden;
      }
      .bar-chart .bar {
          flex: 100%;
          align-self: flex-end;
          margin-right: 2px;
          position: relative;
          background-color: #79aec8;
      }
      .bar-chart .bar:last-child {
          margin: 0;
      }
      .bar-chart .bar:hover {
          background-color: #417690;
      }

      .bar-chart .bar .bar-tooltip {
          position: relative;
          z-index: 999;
      }
      .bar-chart .bar .bar-tooltip {
          position: absolute;
          top: -60px;
          left: 50%;
          transform: translateX(-50%);
          text-align: center;
          font-weight: bold;
          opacity: 0;
      }
      .bar-chart .bar .bar-inside-label {
        text-align: center;
        margin-top: 2px;
        color: white;
      }
      .bar-chart .bar:hover .bar-tooltip {
          opacity: 1;
      }
    </style>

    <div class="results">
        <div class="bar-chart">
        {% for x in summary_over_time %}
            <div class="bar" style="height:{{ x.pct }}%">
                <div class="bar-tooltip">
                  Avg. Score of {{ x.total | default:0 | floatformat:"1" }}%
                  <br>
                  on {{ x.period | date:"m/d/Y" }}
                </div>
                <div class="bar-inside-label">
                  <strong>
                    {{ x.total | default:0 | floatformat:"1" }}%
                  </strong>
                </div>
            </div>
        {% endfor %}
        </div>
    </div>
	
    <br /><br />

    <table>
      <thead>
        <tr>
          <th>
            <div class="text">
              <a href="#">Category</a>
            </div>
          </th>
          <th>
            <div class="text">
              <a href="#">Total</a>
            </div>
          </th>
          <th>
            <div class="text">
              <a href="#">Average Score</a>
            </div>
          </th>
        </tr>
      </thead>

      <tbody>
        {% for row in summary %}
        <tr class="{% cycle 'row1' 'row2' %}">
          <td> {{ row.unit_id__unit_name }} </td>
          <td> {{ row.total | intcomma }} </td>
          <td> {{ row.average_score | default:0 | floatformat:"1" }}% </td>
        </tr>
        {% endfor %}
      </tbody>   
    </table>

</div>
{% endblock results_list %}

{% block pagination %}{% endblock pagination %}